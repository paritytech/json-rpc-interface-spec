<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>archive_unstable_storage</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../objectives.html"><strong aria-hidden="true">1.1.</strong> Objectives</a></li><li class="chapter-item expanded "><a href="../why-json-rpc.html"><strong aria-hidden="true">1.2.</strong> Why JSON-RPC?</a></li><li class="chapter-item expanded "><a href="../grouping-functions-and-node-capabilities.html"><strong aria-hidden="true">1.3.</strong> Grouping functions and node capabilities</a></li><li class="chapter-item expanded "><a href="../dos-attacks-resilience.html"><strong aria-hidden="true">1.4.</strong> DoS attacks resilience</a></li><li class="chapter-item expanded "><a href="../load-balancers.html"><strong aria-hidden="true">1.5.</strong> Load balancers</a></li></ol></li><li class="chapter-item expanded "><a href="../api.html"><strong aria-hidden="true">2.</strong> API specification</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/archive.html"><strong aria-hidden="true">2.1.</strong> archive</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/archive_unstable_body.html"><strong aria-hidden="true">2.1.1.</strong> archive_unstable_body</a></li><li class="chapter-item expanded "><a href="../api/archive_unstable_call.html"><strong aria-hidden="true">2.1.2.</strong> archive_unstable_call</a></li><li class="chapter-item expanded "><a href="../api/archive_unstable_finalizedHeight.html"><strong aria-hidden="true">2.1.3.</strong> archive_unstable_finalizedHeight</a></li><li class="chapter-item expanded "><a href="../api/archive_unstable_genesisHash.html"><strong aria-hidden="true">2.1.4.</strong> archive_unstable_genesisHash</a></li><li class="chapter-item expanded "><a href="../api/archive_unstable_hashByHeight.html"><strong aria-hidden="true">2.1.5.</strong> archive_unstable_hashByHeight</a></li><li class="chapter-item expanded "><a href="../api/archive_unstable_header.html"><strong aria-hidden="true">2.1.6.</strong> archive_unstable_header</a></li><li class="chapter-item expanded "><a href="../api/archive_unstable_storage.html" class="active"><strong aria-hidden="true">2.1.7.</strong> archive_unstable_storage</a></li></ol></li><li class="chapter-item expanded "><a href="../api/chainHead.html"><strong aria-hidden="true">2.2.</strong> chainHead</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/chainHead_v1_body.html"><strong aria-hidden="true">2.2.1.</strong> chainHead_v1_body</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_call.html"><strong aria-hidden="true">2.2.2.</strong> chainHead_v1_call</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_continue.html"><strong aria-hidden="true">2.2.3.</strong> chainHead_v1_continue</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_follow.html"><strong aria-hidden="true">2.2.4.</strong> chainHead_v1_follow</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_header.html"><strong aria-hidden="true">2.2.5.</strong> chainHead_v1_header</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_stopOperation.html"><strong aria-hidden="true">2.2.6.</strong> chainHead_v1_stopOperation</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_storage.html"><strong aria-hidden="true">2.2.7.</strong> chainHead_v1_storage</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_unfollow.html"><strong aria-hidden="true">2.2.8.</strong> chainHead_v1_unfollow</a></li><li class="chapter-item expanded "><a href="../api/chainHead_v1_unpin.html"><strong aria-hidden="true">2.2.9.</strong> chainHead_v1_unpin</a></li></ol></li><li class="chapter-item expanded "><a href="../api/chainSpec.html"><strong aria-hidden="true">2.3.</strong> chainSpec</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/chainSpec_v1_chainName.html"><strong aria-hidden="true">2.3.1.</strong> chainSpec_v1_chainName</a></li><li class="chapter-item expanded "><a href="../api/chainSpec_v1_genesisHash.html"><strong aria-hidden="true">2.3.2.</strong> chainSpec_v1_genesisHash</a></li><li class="chapter-item expanded "><a href="../api/chainSpec_v1_properties.html"><strong aria-hidden="true">2.3.3.</strong> chainSpec_v1_properties</a></li></ol></li><li class="chapter-item expanded "><a href="../api/rpc.html"><strong aria-hidden="true">2.4.</strong> rpc</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/rpc_methods.html"><strong aria-hidden="true">2.4.1.</strong> rpc_methods</a></li></ol></li><li class="chapter-item expanded "><a href="../api/sudo.html"><strong aria-hidden="true">2.5.</strong> sudo</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/sudo_unstable_p2pDiscover.html"><strong aria-hidden="true">2.5.1.</strong> sudo_unstable_p2pDiscover</a></li><li class="chapter-item expanded "><a href="../api/sudo_unstable_pendingTransactions.html"><strong aria-hidden="true">2.5.2.</strong> sudo_unstable_pendingTransactions</a></li><li class="chapter-item expanded "><a href="../api/sudo_unstable_version.html"><strong aria-hidden="true">2.5.3.</strong> sudo_unstable_version</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.6.</strong> sudo_network</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/sudo_network_unstable_unwatch.html"><strong aria-hidden="true">2.6.1.</strong> sudo_network_unstable_unwatch</a></li><li class="chapter-item expanded "><a href="../api/sudo_network_unstable_watch.html"><strong aria-hidden="true">2.6.2.</strong> sudo_network_unstable_watch</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.7.</strong> sudo_sessionKeys</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/sudo_sessionKeys_unstable_generate.html"><strong aria-hidden="true">2.7.1.</strong> sudo_sessionKeys_unstable_generate</a></li></ol></li><li class="chapter-item expanded "><a href="../api/transaction.html"><strong aria-hidden="true">2.8.</strong> transaction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/transaction_v1_broadcast.html"><strong aria-hidden="true">2.8.1.</strong> transaction_v1_broadcast</a></li><li class="chapter-item expanded "><a href="../api/transaction_v1_stop.html"><strong aria-hidden="true">2.8.2.</strong> transaction_v1_stop</a></li></ol></li><li class="chapter-item expanded "><a href="../api/transactionWatch.html"><strong aria-hidden="true">2.9.</strong> transactionWatch</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../api/transactionWatch_v1_submitAndWatch.html"><strong aria-hidden="true">2.9.1.</strong> transactionWatch_v1_submitAndWatch</a></li><li class="chapter-item expanded "><a href="../api/transactionWatch_v1_unwatch.html"><strong aria-hidden="true">2.9.2.</strong> transactionWatch_v1_unwatch</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="archive_unstable_storage"><a class="header" href="#archive_unstable_storage">archive_unstable_storage</a></h1>
<p><strong>Parameters</strong>:</p>
<ul>
<li><code>hash</code>: String containing a hexadecimal-encoded hash of the header of the block whose storage to fetch.</li>
<li><code>items</code>: Array of objects. The structure of these objects is found below.</li>
<li><code>childTrie</code>: <code>null</code> for main storage look-ups, or a string containing the hexadecimal-encoded key of the child trie of the &quot;default&quot; namespace.</li>
</ul>
<p>Each element in <code>items</code> must be an object containing the following fields:</p>
<ul>
<li><code>key</code>: String containing the hexadecimal-encoded key to fetch in the storage.</li>
<li><code>type</code>: String equal to one of: <code>value</code>, <code>hash</code>, <code>closestDescendantMerkleValue</code>, <code>descendantsValues</code>, <code>descendantsHashes</code>.</li>
<li><code>paginationStartKey</code>: This parameter is optional and should be a string containing the hexadecimal-encoded key from which the storage iteration should resume. This parameter is only valid in the context of <code>descendantsValues</code> and <code>descendantsHashes</code>.</li>
</ul>
<p><strong>Return value</strong>: String containing an opaque value representing the operation.</p>
<h2 id="notifications-format"><a class="header" href="#notifications-format">Notifications format</a></h2>
<p>This function will later generate one or more notifications in the following format:</p>
<pre><code class="language-json">{
    &quot;jsonrpc&quot;: &quot;2.0&quot;,
    &quot;method&quot;: &quot;archive_unstable_storageDiffEvent&quot;,
    &quot;params&quot;: {
        &quot;subscription&quot;: &quot;...&quot;,
        &quot;result&quot;: ...
    }
}
</code></pre>
<p>Where <code>subscription</code> is the value returned by this function, and <code>result</code> can be one of:</p>
<h3 id="storage"><a class="header" href="#storage">storage</a></h3>
<pre><code class="language-json">{
    &quot;event&quot;: &quot;storage&quot;,
    &quot;key&quot;: &quot;0x...&quot;,
    &quot;value&quot;: &quot;0x...&quot;,
    &quot;hash&quot;: &quot;0x...&quot;,
    &quot;closestDescendantMerkleValue&quot;: &quot;0x...&quot;,
    &quot;childTrieKey&quot;: &quot;0x...&quot;,
}
</code></pre>
<p>The notification corresponds to a storage response for one of the requested items.</p>
<ul>
<li>
<p><code>key</code>: String containing the hexadecimal-encoded key of the storage entry. This is guaranteed to be equal to one of the <code>key</code>s provided for <code>type</code> equal to <code>value</code>, <code>hash</code> or <code>closestDescendantMerkleValue</code>. For queries of type <code>descendantsValues</code> or <code>descendantsHashes</code>, <code>key</code> is guaranteed to start with one of the <code>key</code>s provided.</p>
</li>
<li>
<p><code>value</code> (optional): String containing the hexadecimal-encoded value of the storage entry. This field is present when the <code>type</code> of the query was <code>&quot;value&quot;</code> or <code>&quot;descendantsValues&quot;</code>.</p>
</li>
<li>
<p><code>hash</code> (optional): String containing the hexadecimal-encoded hash of the storage entry. This field is present when the <code>type</code> of the query was <code>&quot;hash&quot;</code> or <code>&quot;descendantsHashes&quot;</code>.</p>
</li>
<li>
<p><code>closestDescendantMerkleValue</code> (optional): String containing the hexadecimal-encoded Merkle value of the closest descendant of <code>key</code> (including branch nodes). This field is present when the <code>type</code> of the query was <code>&quot;closestDescendantMerkleValue&quot;</code>. The trie node whose Merkle value is indicated in <code>closestDescendantMerkleValue</code> is not indicated, as determining the key of this node might incur an overhead for the JSON-RPC server. The Merkle value is equal to either the node value or the hash of the node value, as defined in the <a href="https://spec.polkadot.network/chap-state#defn-merkle-value">Polkadot specification</a>.</p>
</li>
<li>
<p><code>childTrieKey</code> (optional): String containing the hexadecimal-encoded key of the child trie of the &quot;default&quot; namespace if the storage entry is part of a child trie. If the storage entry is part of the main trie, this field is not present.</p>
</li>
</ul>
<h3 id="storagedone"><a class="header" href="#storagedone">storageDone</a></h3>
<pre><code class="language-json">{
    &quot;event&quot;: &quot;storageDone&quot;,
}
</code></pre>
<p>This event is always generated after all <code>storage</code> events have been generated.</p>
<p>No more events will be generated after a <code>storageDone</code> event.</p>
<h3 id="storageerror"><a class="header" href="#storageerror">storageError</a></h3>
<pre><code class="language-json">{
    &quot;event&quot;: &quot;storageError&quot;,
    &quot;error&quot;: &quot;...&quot;,
}
</code></pre>
<p><code>error</code> is a human-readable error message indicating why the call has failed. This string isn't meant to be shown to end users, but is for developers to understand the problem.</p>
<p>No more events will be generated after a <code>storageError</code> event.</p>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>For each item in <code>items</code>, the JSON-RPC server must start obtaining the value of the entry with the given <code>key</code> from the storage, either from the main trie or from <code>childTrie</code>. If <code>type</code> is <code>descendantsValues</code> or <code>descendantsHashes</code>, then it must also obtain the values of all the descendants of the entry.</p>
<p>For the purpose of storage requests, the trie root hash of the child tries of the storage can be found in the main trie at keys starting the bytes of the ASCII string <code>:child_storage:</code>. This behaviour is consistent with all the other storage-request-alike mechanisms of Polkadot and Substrate-based chains, such as host functions or libp2p network requests.</p>
<p>If the height of the block hash provided is less than or equal to the current finalized block height (which can be obtained via archive_unstable_finalizedHeight), then calling this method with the same parameters will always return the same response.
If the height of the block hash provided is greater than the current finalized block height, then the block might be pruned at any time and calling this method may return null.</p>
<p>This function should be used when the target block is older than the blocks reported by <code>chainHead_v1_follow</code>.
Use <code>chainHead_v1_storage</code> if instead you want to retrieve the storage of a block obtained by the <code>chainHead_v1_follow</code>.</p>
<p>If <code>items</code> contains multiple identical or overlapping queries, the JSON-RPC server can choose whether to merge or not the items in the result. For example, if the request contains two items with the same key, one with <code>hash</code> and one with <code>value</code>, the JSON-RPC server can choose whether to generate two <code>item</code> objects, one with the value and one with the hash, or only a single <code>item</code> object with both <code>hash</code> and <code>value</code> set.</p>
<p>It is allowed (but discouraged) for the JSON-RPC server to provide the same information multiple times in the result, for example providing the <code>value</code> field of the same <code>key</code> twice. Forcing the JSON-RPC server to de-duplicate items in the result might lead to unnecessary overhead.</p>
<h2 id="possible-errors"><a class="header" href="#possible-errors">Possible errors</a></h2>
<ul>
<li>A JSON-RPC error can be generated if the JSON-RPC client has to many active calls to <code>archive_unstable_storageDiff</code>.</li>
<li>A JSON-RPC error with error code <code>-32602</code> is generated if one of the parameters doesn't correspond to the expected type (similarly to a missing parameter or an invalid parameter type).</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../api/archive_unstable_header.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../api/chainHead.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../api/archive_unstable_header.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../api/chainHead.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
